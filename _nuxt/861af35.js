(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{474:function(e,t,r){"use strict";r.r(t);var n=r(13),o=(r(87),r(35),r(36),r(88),r(269)),l=r(19),c=r(267),m=r(31),d=r(11),h=r(24),f={name:"Login",components:{Loading:o.default},layout:"blank",middleware:function(e){var t=e.store,r=e.query,n=e.redirect,o=t.state[h.USER_MODULE_NAME].user,l=r.from||"/";Object(d.e)(o)&&!Object(d.i)(o.id)&&n(l)},asyncData:function(e){var t=e.query,r=t.name,n=void 0===r?"":r,o=t.channel,c=t.bindOld,m=void 0!==c&&c,d=t.platform;return{shopName:n,channel:o,bindOld:m,newStatus:m?void 0:l.h,platform:d}},data:function(){return{listener:null,isLogin:!0,authForm:{username:"",password:"",email:""},rules:{username:[{required:!0,message:"Please enter your username",trigger:"blur"}],password:[{required:!0,message:"Please enter your password",trigger:"blur"},{min:6,message:"Password must be at least 6 characters.",trigger:"blur"}],email:[{require:!0,message:"Please enter your email",trigger:"blur"},{validator:function(e,t,r){Object(d.f)(t)?r():r(new Error("Please enter the correct email format."))},trigger:"blur"}]},stat:m.b}},computed:{title:function(){return this.isLogin?"Log in to your Fashion Express":"Join Fashion Express free"},from:function(){return this.$route.query.from||"/"},isLoading:function(){return this.stat===m.c}},mounted:function(){var e=this;this.listener=window.addEventListener("keydown",(function(t){"ENTER"===t.key.toUpperCase()&&e.submitForm("authForm")}))},beforeDestroy:function(){Object(d.e)(this.timer)&&window.removeEventListener("keydown",this.listener)},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$message({message:"Please fill in the correct information.",type:"warning",duration:l.c}),!1;t.handleSubmit()}))},getFormData:function(){var e={username:this.authForm.username,password:this.authForm.password,channel:l.b,platform:l.d,shopName:this.shopName};return this.isLogin||(e.newStatus=this.newStatus,e.email=this.authForm.email),e},handleClick:function(){var form=this.$refs.authForm;this.isLogin=!this.isLogin,form.clearValidate(),form.resetFields()},handleSubmit:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,f,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$axios,e.stat=m.c,n=e.getFormData(),t.prev=3,t.next=6,r[c.a](n);case 6:f=t.sent,o=f.token,e.stat=m.d,e.$message({message:e.isLogin?"Login successfully!":"Sign in successfully!",duration:l.c,type:"success"}),e.$router.replace(e.from),t.next=18;break;case 13:t.prev=13,t.t0=t.catch(3),console.error("auth: ",t.t0),e.$message({message:t.t0.message,duration:l.c,type:"error"}),e.stat=m.a;case 18:if(Object(d.i)(o)){t.next=26;break}return e.$cookies.set("token",o),t.next=22,r[c.b](o);case 22:v=t.sent,e.$cookies.set("user",Object(d.k)(v,["id","username","channel","platform","email","regionCode","myCode"])),e.$store.commit(h.USER_M_SET_TOKEN,o),e.$store.commit(h.USER_M_SET_USER,v);case 26:case"end":return t.stop()}}),t,null,[[3,13]])})))()}}},v=r(7),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"login w-full h-full flex flex-col justify-center items-center"},[r("loading",{attrs:{"is-loading":e.isLoading}}),e._v(" "),r("h2",{staticClass:"text-3xl font-bold mb-20"},[e._v(e._s(e.title))]),e._v(" "),r("el-form",{ref:"authForm",attrs:{model:e.authForm,rules:e.rules}},[r("el-form-item",{staticClass:"w-96",attrs:{prop:"username"}},[r("el-input",{staticClass:"custom-input",attrs:{placeholder:"Username"},model:{value:e.authForm.username,callback:function(t){e.$set(e.authForm,"username",t)},expression:"authForm.username"}})],1),e._v(" "),e.isLogin?e._e():r("el-form-item",{staticClass:"w-96",attrs:{prop:"email"}},[r("el-input",{staticClass:"custom-input",attrs:{placeholder:"Email"},model:{value:e.authForm.email,callback:function(t){e.$set(e.authForm,"email",t)},expression:"authForm.email"}})],1),e._v(" "),r("el-form-item",{staticClass:"w-96 h-10",attrs:{prop:"password"}},[r("el-input",{staticClass:"custom-input",attrs:{placeholder:"Password",type:"password"},model:{value:e.authForm.password,callback:function(t){e.$set(e.authForm,"password",t)},expression:"authForm.password"}})],1),e._v(" "),r("el-form-item",{staticClass:"w-96 mt-8"},[r("el-button",{staticClass:"w-full primary-button",staticStyle:{padding:"0.75rem 0","font-size":"1.25rem","font-weight":"550"},on:{click:function(t){return e.submitForm("authForm")}}},[e._v(e._s(e.isLogin?"Login":"Join Fashion Express"))])],1)],1),e._v(" "),e.isLogin?r("p",[e._v("\n    Don't have a Fashion Express account?\n    "),r("span",{staticClass:"cursor-pointer",staticStyle:{color:"var(--color-link)"},on:{click:e.handleClick}},[e._v("Sign up now")])]):r("p",[e._v("\n    Already have an account?\n    "),r("span",{staticClass:"cursor-pointer",staticStyle:{color:"var(--color-link)"},on:{click:e.handleClick}},[e._v("Log In")])])],1)}),[],!1,null,"51fdf154",null);t.default=component.exports}}]);